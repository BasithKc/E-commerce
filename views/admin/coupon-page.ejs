<%- include('partials/header.ejs') %>
  <div class="container mt-5">
    <h2 style="text-align: center;text-transform: uppercase;color: white;">Coupons Management</h2>
    <div class="row tm-content-row">
      <%if(message[0]) { %>
        <div id="notification" class="notification hidden">
          <i class="fa-sharp fa-solid fa-check" style="color: #FFD43B;"></i>
          <%= message %>
        </div>
        <% } %>
        <div class="col-2" style="margin-bottom: 30px;">
          <button class=" btn btn-primary btn-block text-uppercase " id="addBannerButton">Add Coupon <i
              class="fa-solid fa-plus" id="add-specification"></i>
          </button>
        </div>
          <div class="col-sm-12 col-md-12 col-lg-8 col-xl-12 tm-block-col">
            <div class="tm-bg-primary-dark tm-block">
              <div class="tm-product-table-container">
                <table class="table table-hover tm-table-small tm-product-table">
                  <thead>
                    <tr>

                      <th scope="col">COUPON CODE</th>
                      <th scope="col">MIN ORDER AMOUNT</th>
                      <th scope="col">DISCOUNT(%)</th>
                      <th scope="col">START DATE</th>
                      <th scope="col">EXPIRE DATE</th>
                      <th scope="col">&nbsp;</th>
                      <th scope="col">&nbsp;</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% coupons.forEach(coupon=>{%>
                      <tr>

                        <td class="tm-product-name">
                          <%=coupon.coupon_code%>
                        </td>
                      
                        <td>
                          <%=coupon.minOrderAmount%>
                        </td>

                        <td>
                          <%= coupon.discount %>
                        </td>

                        <td>
                          <%= coupon.start_date %>
                        </td>
                        <td>
                          <%=coupon.expire_date%>
                        </td>
                        <td>
                          <a href="/admin/coupons/edit-coupon/<%=coupon._id%>" class="tm-product-edit-link">
                            <i class="far fa-solid fa-pen-to-square "></i>
                          </a>
                        </td>


                        <td>
                          <a href="/admin/coupons/delete-coupon/<%=coupon._id%>" class="tm-product-delete-link">
                            <i class="far fa-trash-alt tm-product-delete-icon"></i>
                          </a>
                        </td>
                      </tr>
                      <%})%>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
    </div>
  </div>

  <div class="container">
    <div class="row">
      <div class=" col-xl-5 col-lg-7 col-md-7 col-sm-12 mx-auto" id="modal">
        <div class="tm-bg-primary-dark tm-block tm-block-h-auto">
          <span class="close">&times;</span>

          <div class="row tm-edit-product-row">
            <div class="col-xl-12 col-lg-7 col-md-12">

              <form action="/admin/coupons" method="post">
                <div class="form-group mb-3">
                  <label for="coupon_code">Coupon Code
                  </label>
                  <input id="coupon_code" name="coupon_code" type="text" class="form-control validate" value="<%= couponCode %>" readonly   style="color: black;"/>
                </div>
                <div class="form-group mb-3">
                  <label for="minOrderAmount">Min Order Amount
                  </label>
                  <input id="minOrderAmount" name="minOrderAmount" type="number" class="form-control validate"  />
                </div>

                <div class="form-group mb-3">
                  <label for="discount">Discount</label>
                  <input class="form-control validate" type="number" name="discount" id="discount" required/>
                </div>

                <div class="form-group mb-3 ">
                  <label for="start_date">Start Date
                  </label>
                  <input id="start_date" name="start_date" type="date" class="form-control validate"
                    data-large-mode="true" />
                </div>

                <div class="form-group mb-3 ">
                  <label for="expire_date">Expire Date
                  </label>
                  <input id="expire_date" name="expire_date" type="date" class="form-control validate"
                    data-large-mode="true" />
                </div>
            </div>
            
          </div>
          <div class="col-12">
            <button type="submit" class="btn btn-primary btn-block text-uppercase">Add Coupon</button>
          </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div id="overlay" class="overlay"></div>

  <footer class="tm-footer row tm-mt-small">
    <div class="col-12 font-weight-light">
      <p class="text-center text-white mb-0 px-4 small">
        Copyright &copy; <b>2018</b> All rights reserved.

        Design: <a rel="nofollow noopener" href="https://templatemo.com" class="tm-footer-link">Template
          Mo</a>
      </p>
    </div>
  </footer>
  </div>
  <script>
    const notification = document.getElementById('notification');
    setTimeout(function () {
      notification.style.display = 'none';
    }, 5000);

    document.getElementById('addBannerButton').addEventListener('click', function () {
      document.getElementById('modal').style.display = 'block';
      document.getElementById('overlay').style.display = 'block';
    });

    document.querySelector('.close').addEventListener('click', function () {
      document.getElementById('modal').style.display = 'none';
      document.getElementById('overlay').style.display = 'none';
    });
  </script>
  </body>

  </html>